(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1974c6ef"],{2243:function(t,e,i){},"751e":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rcmd-mv"},[i("div",{ref:"imgbox",staticClass:"img-box"},[i("transition",{attrs:{name:"fadeIn"}},[t.imgShow?i("img",{ref:"img",on:{click:function(e){return t.clickVideo(t.rcmdMv.id)}}}):t._e()]),i("video",{ref:"rcmdVideo",on:{click:function(e){return t.clickVideo(t.rcmdMv.id)},play:t.vdoPlay,pause:t.vdoPause,error:t.vdoErr,playing:t.playing,waiting:t.waiting}}),t.updateTime?i("span",{staticClass:"duration"},[t._v(t._s(t.updateTime))]):i("span",{staticClass:"duration"},[t._v(t._s(t.duration))]),t.playStatus.length?i("div",{staticClass:"play-status"},[i("van-loading",{directives:[{name:"show",rawName:"v-show",value:"stop"===t.playStatus,expression:"playStatus==='stop'"}],attrs:{size:".14rem",color:"#fff"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:"play"===t.playStatus,expression:"playStatus==='play'"}],staticClass:"loader"},[i("div",{staticStyle:{"--x":"0"}}),i("div",{staticStyle:{"--x":"1"}}),i("div",{staticStyle:{"--x":"2"}})])],1):t._e()],1),i("div",{staticClass:"mv-info",on:{click:t.toMvPlayer}},[i("div",{staticClass:"name two-eli"},[t._v(t._s(t.rcmdMv.name))]),i("div",{staticClass:"playinfo"},[i("div",{staticClass:"count"},[i("i",{staticClass:"iconfont icon-bofangsanjiaoxing"}),i("span",[t._v(t._s(t._f("formatNum")(t.rcmdMv.playCount)))])]),t.rcmdMv.praisedCount?i("div",{staticClass:"praised-count"},[i("i",{staticClass:"iconfont icon-zan"}),i("span",[t._v(t._s(t._f("formatNum")(t.rcmdMv.praisedCount)))])]):t._e(),i("div",{staticClass:"tag text-eli"},[t._v(t._s(t.rcmdMv.tag))])])])])},a=[],n=i("1da1"),r=(i("ac1f"),i("159b"),i("99af"),i("96cf"),i("4ec3")),c=i("c1df"),o=i.n(c),d=i("5a84"),u={mixins:[d["a"]],props:{rcmdMv:{type:Object,default:function(){return{}}}},data:function(){return{imgShow:!1,bgc:["#f58a8a","#f59f8a","#f5c78a","#9ee0b4","#a8f58a","#e5f58a","#9ecfe0","#9eabe0","#c59ee0","#f7c7b2"],vdoTimer:null,updateTime:0,playStatus:""}},computed:{duration:function(){return o()(this.rcmdMv.duration).format("mm:ss")}},mounted:function(){this.loadImg(),this.visible()},methods:{loadImg:function(){var t=this;this.$refs.imgbox.style.background=this.bgc[this.roundNum(0,this.bgc.length-1)];var e=new Image;e.src=this.rcmdMv.img,e.onload=function(){t.imgShow=!0,t.$nextTick((function(){t.$refs.img.src=t.rcmdMv.img}))}},roundNum:function(t,e){return Math.round(Math.random()*(e-t)+t)},clickVideo:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){var s,a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e.$store.commit("changeMvId",t),e.playStatus="stop",i.prev=2,s=e.$refs.rcmdVideo,s.src){i.next=17;break}if(!e.rcmdMv.url){i.next=9;break}s.src=e.rcmdMv.url,i.next=14;break;case 9:return i.next=11,Object(r["n"])(t);case 11:a=i.sent,a=a.data.url,s.src=a;case 14:s.oncanplay=function(){s.play(),e.$refs.img.style.zIndex="-1"},i.next=18;break;case 17:e.toggleVdoStatus();case 18:i.next=23;break;case 20:i.prev=20,i.t0=i["catch"](2),console.log(i.t0);case 23:case"end":return i.stop()}}),i,null,[[2,20]])})))()},toggleVdoStatus:function(){var t=this.$refs.rcmdVideo;t.paused?t.play():t.pause()},setPStatus:function(t){var e=this;setTimeout((function(){e.playStatus=t}),100)},vdoTimeUpdate:function(){var t=this.$refs.rcmdVideo;this.updateTime=o()(1e3*parseInt(Math.ceil(t.currentTime))).format("mm:ss")},vdoPlay:function(){var t=this;this.setPStatus("stop"),this.getVdoCTime(),this.vdoTimer=setInterval((function(){t.getVdoCTime()}),1e3)},getVdoCTime:function(){var t=this.$refs.rcmdVideo,e=t.currentTime;"number"!==typeof e&&(e=0),this.updateTime=o()(1e3*parseInt(t.duration-Math.ceil(e))).format("mm:ss")},vdoPause:function(){clearInterval(this.vdoTimer),this.setPStatus("")},vdoErr:function(){this.$toast("网络原因, 视频播放错误!")},visible:function(){var t=this,e=0;try{var i=document.querySelector("html");e=window.getComputedStyle(i).fontSize,e=.5*parseInt(/(\d+)/g.exec(e)[0]),e=e>0?"-"+e+"px":"-30px"}catch(a){e="-30px"}var s=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting||t.$refs.rcmdVideo.paused||t.$refs.rcmdVideo.pause()}))}),{rootMargin:"".concat(e," 0px ").concat(e," 0px")});s.observe(this.$refs.rcmdVideo)},playing:function(){this.setPStatus("play")},waiting:function(){this.setPStatus("stop")},toMvPlayer:function(){this.loginStatus?this.clickMvIcon(this.rcmdMv.id,"video"):this.clickMvIcon(this.rcmdMv.id,"mv")}},watch:{"$store.getters.mvId":{handler:function(t){t!==this.rcmdMv.id&&(this.updateTime=o()(this.rcmdMv.duration).format("mm:ss"),this.$refs.rcmdVideo.pause(),this.$refs.rcmdVideo.removeAttribute("src"),this.$refs.rcmdVideo.load(),clearInterval(this.vdoTimer),this.setPStatus(""),this.$refs.img.style.zIndex="")}}}},m=u,l=(i("fc20"),i("fd1f"),i("2877")),f=Object(l["a"])(m,s,a,!1,null,"e137bc94",null);e["default"]=f.exports},dcb1:function(t,e,i){},fc20:function(t,e,i){"use strict";i("2243")},fd1f:function(t,e,i){"use strict";i("dcb1")}}]);
//# sourceMappingURL=chunk-1974c6ef.6391f420.js.map